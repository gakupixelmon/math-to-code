## 拡散方程式
∂u/∂t = ν ∂<sup>2</sup>u/∂x<sup>2</sup>
鉄の棒の熱伝導で使われる方程式です。離散化という、極小を小さな有理数で近似することによって表現します。
```
import numpy as np #numpyは有名なライブラリで行列を計算できます
import matplotlib.pyplot as plt #グラフ表示用のライブラリです

def solve_heat_equation():
    # --- 1. 設定（人間が決めること） ---
    nx = 51             # 棒を何分割するか（グリッド数）
    dx = 2.0 / (nx - 1) # グリッドの間隔
    nt = 100            # 計算する回数（時間ステップ）
    nu = 0.3            # 熱の伝わりやすさ(拡散係数)
    dt = 0.002          # 1回の計算で進める時間
    
    # x座標を作る（0から2まで）
    x = np.linspace(0, 2, nx)
    
    # --- 2. 初期状態を作る ---
    # 温度 u の入れ物を作る（最初は全部 1.0）
    u = np.ones(nx)
    
    # 真ん中だけ熱くする（温度 2.0 に設定）
    # 0.5 < x < 1.0 の範囲を加熱
    u[int(0.5 / dx):int(1 / dx + 1)] = 2.0
    
    # 初期状態を保存（比較用）
    u_initial = u.copy()

    # --- 3. 計算（コンピュータがやること） ---
    # 時間を少しずつ進めるループ
    for n in range(nt):
        un = u.copy() # 1つ前の時間の温度
        
        # ★ここが偏微分方程式の計算（差分法）
        # 「未来の自分」 = 「今の自分」 + 「拡散による変化」
        # u[1:-1] は「端っこ以外のすべて」という意味です
        u[1:-1] = un[1:-1] + nu * dt / dx**2 * (un[2:] - 2*un[1:-1] + un[0:-2])
        
        # ※境界条件：棒の両端の温度は 1.0 のまま固定
        u[0] = 1.0
        u[-1] = 1.0

    # --- 4. 結果の表示 ---
    plt.plot(x, u_initial, label='Initial (t=0)', linestyle='--')
    plt.plot(x, u, label=f'Result (t={nt*dt:.2f})')
    plt.title("1D Heat Equation")
    plt.xlabel("Position x")
    plt.ylabel("Temperature u")
    plt.legend()
    plt.grid()
    plt.show()

# 実行
solve_heat_equation()
```
